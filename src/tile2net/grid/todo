reminder about: https://shapely.readthedocs.io/en/latest/reference/shapely.remove_repeated_points.html

We can use something like the majority vote + confidence mask to force the labels of the pixels with low confidence into the same label as their neighbors starting from like 50 pixels away from the edge

add a changelog
we should have vecgrid.prediction and vecgrid.mask
we must dissolve before simplifying

stitch loader should still use threading within a process if a lot of small grid in the big tile


outdir not correctly being set


The user wants the end result
We should delete them by default and only keep it if explicitly passed


vecgrid.file.colored
vecgrid.padded.file.colored

previews are too slow

problem is, seggrid.broadcast.index implicates more tiles than just seggrid.index


Network preview
/tmp/tile2net/bRs07FIb0QB5n-8b/lines/preview/Lines-09a6f0fafc9acf0e-9c1419be84668cbe356eb631f0807484.png

seggrid.padded.infile

seggrid.broadcast.infile

filename hash based

python -m tile2net --location "boston common"    --outdir ./l=boston_common__zoom=20__segment.pad=0 --zoom 20 --segment.pad 0 --model.bs_val 8 --vector.length 8

python -m tile2net --location 'boston common' --name segment.pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
--location "boston common" --name segment.pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8

python -m tile2net --location "boston common" --name pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
python -m tile2net --location "boston common" --name pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8
python -m tile2net --location "boston common" --name pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8
python -m tile2net --location "boston common" --name pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8
python -m tile2net --location "boston common" --name pad=4 --segment.pad 4 --zoom 20 --model.bs_val 1 --vector.length 8

python -m tile2net --location "boston common" --name pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
python -m tile2net --location "boston common" --name pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8
python -m tile2net --location "boston common" --name pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8
python -m tile2net --location "boston common" --name pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8
python -m tile2net --location "boston common" --name pad=4 --segment.pad 4 --zoom 20 --model.bs_val 1 --vector.length 8

python -m tile2net --location "boston common" --name multiscale/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5 1.5 2
python -m tile2net --location "boston common" --name multiscale/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5 1.5 2
python -m tile2net --location "boston common" --name multiscale/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5 1.5 2
python -m tile2net --location "boston common" --name multiscale/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5 1.5 2
python -m tile2net --location "boston common" --name multiscale/pad=4 --segment.pad 4 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5 1.5 2

python -m tile2net --location "boston common" --name multiscale/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 2 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,1.5,2
python -m tile2net --location "boston common" --name multiscale/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,1.5,2
python -m tile2net --location "boston common" --name multiscale/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,1.5,2
python -m tile2net --location "boston common" --name multiscale/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,1.5,2
python -m tile2net --location "boston common" --name multiscale/pad=4 --segment.pad 4 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,1.5,2


bounding box seems to fail?

python -m tile2net --location "boston common" --name scales=0.5,2/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "boston common" --name scales=0.5,2/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "boston common" --name scales=0.5,2/pad=1 --segment.pad 3 --zoom 20 --model.bs_val 3 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2

python -m tile2net --location "boston common" --name singlescale/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=4 --segment.pad 4 --zoom 20 --model.bs_val 1 --vector.length 8

--location "boston common" --name pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8

python -m tile2net \
  -l "Cambridge, MA" \
  -b 16 \
  -o ./cambridge \
  -v 8 \
  --no-cleanup


python -m tile2net -l "Cambridge, MA" --name cambridge/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net -l "Cambridge, MA" --name cambridge/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net -l "Cambridge, MA" --name cambridge/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net -l "Cambridge, MA" --name cambridge/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8  --line.preview 8192 --polygon.preview 8192
python -m tile2net -l "Cambridge, MA" --name cambridge/pad=4 --segment.pad 4 --zoom 20 --model.bs_val 1 --vector.length 8 --line.preview 8192 --polygon.preview 8192


python -m tile2net --location "boston common" --name singlescale/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8
python -m tile2net --location "boston common" --name singlescale/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8
python -m tile2net --location "boston common" --name scales=0.5,2/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "boston common" --name scales=0.5,2/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "boston common" --name scales=0.5,2/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "boston common" --name scales=0.5,2/pad=1 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2


python -m tile2net --location "madison square park" --name unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
python -m tile2net --location "madison square park" --name unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8
python -m tile2net --location "madison square park" --name unscaled/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8
python -m tile2net --location "madison square park" --name unscaled/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8
python -m tile2net --location "madison square park" --name unscaled/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8
python -m tile2net --location "madison square park" --name scales=0.5,2/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "madison square park" --name scales=0.5,2/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "madison square park" --name scales=0.5,2/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "madison square park" --name scales=0.5,2/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2

python -m tile2net --location "financial district, new york city" --name fidi/unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "Zuccotti Park" --name zucotti/unscaled/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8
python -m tile2net --location "Zuccotti Park" --name zucotti/unscaled/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8
python -m tile2net --location "Zuccotti Park" --name zucotti/unscaled/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8
python -m tile2net --location "Zuccotti Park" --name zucotti/scales=0.5,2/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "Zuccotti Park" --name zucotti/scales=0.5,2/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "Zuccotti Park" --name zucotti/scales=0.5,2/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2
python -m tile2net --location "Zuccotti Park" --name zucotti/scales=0.5,2/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2

python -m tile2net --location "uc berkeley" --name berkeley/unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --line.preview 8192 --polygon.preview 8192

python -m tile2net --location "cambridge, MA" --name cambridge/unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --line.preview 8192 --polygon.preview 8192

python -m tile2net --location "zuccotti park" --name zuccotti/unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --line.preview 8192 --polygon.preview 8192


python -m tile2net --location "financial district, new york city" --name fidi/unscaled/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 8 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "financial district, new york city" --name fidi/unscaled/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 4 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "financial district, new york city" --name fidi/unscaled/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 2 --vector.length 8 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "financial district, new york city" --name fidi/unscaled/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --line.preview 8192 --polygon.preview 8192

python -m tile2net --location "financial district, new york city" --name fidi/scales=0.5,2/pad=0 --segment.pad 0 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "financial district, new york city" --name fidi/scales=0.5,2/pad=1 --segment.pad 1 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "financial district, new york city" --name fidi/scales=0.5,2/pad=2 --segment.pad 2 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2 --line.preview 8192 --polygon.preview 8192
python -m tile2net --location "financial district, new york city" --name fidi/scales=0.5,2/pad=3 --segment.pad 3 --zoom 20 --model.bs_val 1 --vector.length 8 --multi_scale_inference --model.extra_scales 0.5,2 --line.preview 8192 --polygon.preview 8192
